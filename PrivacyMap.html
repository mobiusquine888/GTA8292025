<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>U.S. Cities Privacy Map Demo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <!-- MarkerCluster CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.Default.css" />

  <style>
    body { margin:0; padding:0; }
    #map { height: 100vh; width: 100%; }
    .legend {
      background: white;
      padding: 10px;
      line-height: 18px;
      color: #555;
    }
    .legend span {
      display: inline-block;
      width: 20px;
      height: 20px;
      margin-right: 5px;
    }
  </style>
</head>
<body>

<div id="map"></div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<!-- MarkerCluster JS -->
<script src="https://unpkg.com/leaflet.markercluster/dist/leaflet.markercluster.js"></script>

<script>
  // Initialize map
  var map = L.map('map').setView([39.8, -98.5], 4); // Center of the U.S.

  // Add OpenStreetMap tiles
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19,
    attribution: 'Â© OpenStreetMap'
  }).addTo(map);

  // Create marker cluster group
  var markers = L.markerClusterGroup();

  // Demo dataset: U.S. cities with lat, lng, population
  // (In a real version you can replace this array with the full dataset)
  var cities = [
    {name: "New York", lat: 40.7128, lng: -74.0060, population: 8419600},
    {name: "Los Angeles", lat: 34.0522, lng: -118.2437, population: 3980400},
    {name: "Chicago", lat: 41.8781, lng: -87.6298, population: 2716000},
    {name: "Denver", lat: 39.7392, lng: -104.9903, population: 715000},
    {name: "Austin", lat: 30.2672, lng: -97.7431, population: 978000},
    {name: "Boulder", lat: 40.01499, lng: -105.27055, population: 108000},
    // ... add all other cities here
  ];

  // Function to get marker color based on demo privacy score
  function getColor(score) {
    return score > 80 ? '#d73027' :
           score > 60 ? '#fc8d59' :
           score > 40 ? '#fee08b' :
           score > 20 ? '#d9ef8b' :
                        '#1a9850';
  }

  // Add markers
  cities.forEach(function(city) {
    var privacyScore = Math.floor(Math.random() * 100) + 1; // Random demo score
    var marker = L.circleMarker([city.lat, city.lng], {
      radius: Math.max(5, Math.log(city.population)/2),
      fillColor: getColor(privacyScore),
      color: '#555',
      weight: 1,
      opacity: 1,
      fillOpacity: 0.8
    }).bindPopup(
      "<b>" + city.name + "</b><br>" +
      "Population: " + city.population.toLocaleString() + "<br>" +
      "Demo Privacy Score: " + privacyScore
    );
    markers.addLayer(marker);
  });

  map.addLayer(markers);

  // Add legend
  var legend = L.control({position: 'bottomright'});
  legend.onAdd = function (map) {
    var div = L.DomUtil.create('div', 'legend');
    div.innerHTML += "<b>Demo Privacy Score</b><br>";
    div.innerHTML += '<span style="background:#d73027"></span> 81-100<br>';
    div.innerHTML += '<span style="background:#fc8d59"></span> 61-80<br>';
    div.innerHTML += '<span style="background:#fee08b"></span> 41-60<br>';
    div.innerHTML += '<span style="background:#d9ef8b"></span> 21-40<br>';
    div.innerHTML += '<span style="background:#1a9850"></span> 0-20<br>';
    return div;
  };
  legend.addTo(map);
</script>

</body>
</html>
